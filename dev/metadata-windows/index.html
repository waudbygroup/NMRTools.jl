<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Window functions · NMRTools.jl</title><meta name="title" content="Window functions · NMRTools.jl"/><meta property="og:title" content="Window functions · NMRTools.jl"/><meta property="twitter:title" content="Window functions · NMRTools.jl"/><meta name="description" content="Documentation for NMRTools.jl."/><meta property="og:description" content="Documentation for NMRTools.jl."/><meta property="twitter:description" content="Documentation for NMRTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NMRTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NMRTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorial-data/">Working with NMR data</a></li><li><a class="tocitem" href="../tutorial-plotrecipes/">Plotting</a></li><li><a class="tocitem" href="../tutorial-metadata/">Metadata</a></li><li><a class="tocitem" href="../tutorial-animation/">Animating spectra</a></li><li><a class="tocitem" href="../tutorial-relaxation/">1D relaxation analysis</a></li><li><a class="tocitem" href="../tutorial-diffusion/">Diffusion analysis</a></li></ul></li><li><span class="tocitem">Metadata</span><ul><li><a class="tocitem" href="../metadata/">Overview</a></li><li><a class="tocitem" href="../metadata-timeunits/">Times and frequencies</a></li><li><a class="tocitem" href="../metadata-power/">Power levels</a></li><li><a class="tocitem" href="../metadata-fqlists/">Frequency lists</a></li><li class="is-active"><a class="tocitem" href>Window functions</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Available-window-functions"><span>Available window functions</span></a></li><li><a class="tocitem" href="#Working-with-window-functions"><span>Working with window functions</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><span class="tocitem">Reference guide</span><ul><li><a class="tocitem" href="../ref-metadata/">Metadata</a></li><li><a class="tocitem" href="../ref-annotations/">Annotations</a></li><li><a class="tocitem" href="../ref-coherences/">Coherences and isotope data</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../indexes/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Metadata</a></li><li class="is-active"><a href>Window functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Window functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRTools.jl/blob/master/docs/src/metadata-windows.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Window-functions"><a class="docs-heading-anchor" href="#Window-functions">Window functions</a><a id="Window-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Window-functions" title="Permalink"></a></h1><p>Window functions (also called apodization functions) are applied to time-domain NMR data before Fourier transformation to modify the lineshape and signal-to-noise characteristics of the resulting spectrum. NMRTools automatically detects and stores the window function used during processing.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Window functions are represented by subtypes of the abstract type <a href="../api/#NMRTools.NMRBase.WindowFunction"><code>WindowFunction</code></a>. Each window function type stores:</p><ul><li>Parameters specific to that window function</li><li>The acquisition time <code>tmax</code> (calculated after linear prediction but before zero filling)</li></ul><p>Window functions are stored as axis metadata and can be accessed through the <code>:window</code> key:</p><pre><code class="language-julia hljs">using NMRTools

# Load example spectrum
spec = exampledata(&quot;2D_HN&quot;)

# Get the window function for a specific dimension
window = spec[F2Dim, :window]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CosWindow(0.04783359999999993)</code></pre><h2 id="Available-window-functions"><a class="docs-heading-anchor" href="#Available-window-functions">Available window functions</a><a id="Available-window-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Available-window-functions" title="Permalink"></a></h2><h3 id="No-apodization"><a class="docs-heading-anchor" href="#No-apodization">No apodization</a><a id="No-apodization-1"></a><a class="docs-heading-anchor-permalink" href="#No-apodization" title="Permalink"></a></h3><p><strong><code>NullWindow(tmax)</code></strong></p><p>Represents no apodization applied to the data. The multiplication factor is 1.0 for all time points.</p><pre><code class="language-julia hljs">w = NullWindow(0.1)  # 0.1 second acquisition time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">NullWindow(0.1)</code></pre><h3 id="Unknown-apodization"><a class="docs-heading-anchor" href="#Unknown-apodization">Unknown apodization</a><a id="Unknown-apodization-1"></a><a class="docs-heading-anchor-permalink" href="#Unknown-apodization" title="Permalink"></a></h3><p><strong><code>UnknownWindow(tmax)</code></strong></p><p>Used when the window function cannot be determined from the processing parameters. This typically occurs with older data formats or non-standard processing.</p><h3 id="Exponential-(line-broadening)"><a class="docs-heading-anchor" href="#Exponential-(line-broadening)">Exponential (line broadening)</a><a id="Exponential-(line-broadening)-1"></a><a class="docs-heading-anchor-permalink" href="#Exponential-(line-broadening)" title="Permalink"></a></h3><p><strong><code>ExponentialWindow(lb, tmax)</code></strong></p><p>Exponential apodization with line broadening <code>lb</code> in Hz. This is the most common apodization function in NMR processing.</p><p class="math-container">\[w(t) = \exp(-\pi \cdot \mathrm{lb} \cdot t)\]</p><pre><code class="language-julia hljs"># 5 Hz line broadening, 0.1 s acquisition
w = ExponentialWindow(5.0, 0.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ExponentialWindow(5.0, 0.1)</code></pre><p><strong>Effect:</strong></p><ul><li>Positive <code>lb</code>: Increases line broadening, improves S/N, reduces resolution</li><li>Negative <code>lb</code>: Decreases line broadening (resolution enhancement), degrades S/N</li><li>Typical values: 1-10 Hz for routine 1D proton spectra</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Get line broadening from a loaded spectrum
lb = spec[F2Dim, :window]
println(&quot;Line broadening: &quot;, lb)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Line broadening: CosWindow(0.04783359999999993)</code></pre><h3 id="Sine/Cosine-windows"><a class="docs-heading-anchor" href="#Sine/Cosine-windows">Sine/Cosine windows</a><a id="Sine/Cosine-windows-1"></a><a class="docs-heading-anchor-permalink" href="#Sine/Cosine-windows" title="Permalink"></a></h3><p><strong><code>CosWindow(tmax)</code></strong></p><p>Pure cosine (half-period) window function:</p><p class="math-container">\[w(t) = \cos\left(\frac{\pi t}{2t_{\mathrm{max}}}\right)\]</p><pre><code class="language-julia hljs">w = CosWindow(0.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CosWindow(0.1)</code></pre><p><strong>Effect:</strong> Commonly used for indirect dimensions in multidimensional NMR. Improves resolution with moderate S/N penalty.</p><hr/><p><strong><code>Cos²Window(tmax)</code></strong></p><p>Squared cosine window function:</p><p class="math-container">\[w(t) = \cos^2\left(\frac{\pi t}{2t_{\mathrm{max}}}\right)\]</p><pre><code class="language-julia hljs">w = Cos²Window(0.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Cos²Window(0.1)</code></pre><p><strong>Effect:</strong> Gentler apodization than cosine, better S/N but slightly lower resolution.</p><hr/><p><strong><code>GeneralSineWindow(offset, endpoint, power, tmax)</code></strong></p><p>General sine window function with adjustable parameters:</p><p class="math-container">\[w(t) = \left[\sin\left(
    \pi \cdot \mathrm{offset} +
    \frac{(\mathrm{endpoint} - \mathrm{offset})\pi t}{t_{\mathrm{max}}}
    \right)\right]^{\mathrm{power}}\]</p><p><strong>Parameters:</strong></p><ul><li><code>offset</code>: Initial phase (0 to 1), determines starting value</li><li><code>endpoint</code>: Final phase (0 to 1), determines ending value</li><li><code>power</code>: Exponent applied to sine function</li><li><code>tmax</code>: Acquisition time</li></ul><pre><code class="language-julia hljs"># Typical shifted sine-bell
w = GeneralSineWindow(0.5, 1.0, 2.0, 0.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeneralSineWindow(0.5, 1.0, 2.0, 0.1)</code></pre><p><strong>Special cases:</strong></p><ul><li><code>offset=0.5, power=1.0</code> → <code>CosWindow</code></li><li><code>offset=0.5, power=2.0</code> → <code>Cos²Window</code></li></ul><h3 id="Gaussian-windows"><a class="docs-heading-anchor" href="#Gaussian-windows">Gaussian windows</a><a id="Gaussian-windows-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-windows" title="Permalink"></a></h3><p><strong><code>LorentzToGaussWindow(expHz, gaussHz, tmax)</code></strong></p><p>Lorentz-to-Gauss transformation, combining inverse exponential with Gaussian broadening:</p><p class="math-container">\[w(t) = \exp(+\pi \cdot \mathrm{expHz} \cdot t) \cdot \exp\left(-\frac{(\pi \cdot \mathrm{gaussHz} \cdot t)^2}{2}\right)\]</p><pre><code class="language-julia hljs"># 5 Hz inverse exponential, 10 Hz Gaussian
w = LorentzToGaussWindow(5.0, 10.0, 0.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LorentzToGaussWindow(5.0, 10.0, 0.1)</code></pre><p><strong>Parameters:</strong></p><ul><li><code>expHz</code>: Inverse exponential (line narrowing) in Hz</li><li><code>gaussHz</code>: Gaussian broadening in Hz</li><li><code>tmax</code>: Acquisition time</li></ul><p><strong>Effect:</strong> Converts Lorentzian lineshapes (natural in NMR) to Gaussian lineshapes. Improves resolution for crowded spectra but requires careful parameter optimization.</p><hr/><p><strong><code>GeneralGaussWindow(expHz, gaussHz, center, tmax)</code></strong></p><p>General Gaussian window with adjustable center position:</p><p class="math-container">\[w(t) = \exp(+\pi \cdot \mathrm{expHz} \cdot t) \cdot
       \exp\left(-\frac{(\pi \cdot \mathrm{gaussHz} \cdot (t - t_{\mathrm{center}}))^2}{2}\right)\]</p><p><strong>Parameters:</strong></p><ul><li><code>expHz</code>: Inverse exponential in Hz</li><li><code>gaussHz</code>: Gaussian broadening in Hz</li><li><code>center</code>: Position of Gaussian maximum (0 to 1)</li><li><code>tmax</code>: Acquisition time</li></ul><pre><code class="language-julia hljs"># Shifted Gaussian window
w = GeneralGaussWindow(5.0, 10.0, 0.3, 0.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeneralGaussWindow(5.0, 10.0, 0.3, 0.1)</code></pre><p><strong>When center = 0:</strong> Simplifies to <code>LorentzToGaussWindow</code></p><h2 id="Working-with-window-functions"><a class="docs-heading-anchor" href="#Working-with-window-functions">Working with window functions</a><a id="Working-with-window-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-window-functions" title="Permalink"></a></h2><h3 id="Extracting-window-parameters"><a class="docs-heading-anchor" href="#Extracting-window-parameters">Extracting window parameters</a><a id="Extracting-window-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Extracting-window-parameters" title="Permalink"></a></h3><p>Window function objects store their parameters as fields:</p><pre><code class="language-julia hljs"># Load spectrum
spec = exampledata(&quot;2D_HN&quot;)

# Get window for F2 dimension
win = spec[F2Dim, :window]

# For ExponentialWindow
if win isa ExponentialWindow
    println(&quot;Line broadening: &quot;, win.lb, &quot; Hz&quot;)
    println(&quot;Acquisition time: &quot;, win.tmax, &quot; s&quot;)
end

# For sine windows
if win isa CosWindow
    println(&quot;Acquisition time: &quot;, win.tmax, &quot; s&quot;)
end</code></pre><h3 id="Computing-the-apodization-function"><a class="docs-heading-anchor" href="#Computing-the-apodization-function">Computing the apodization function</a><a id="Computing-the-apodization-function-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-apodization-function" title="Permalink"></a></h3><p>The <a href="../api/#NMRTools.NMRBase.apod"><code>apod</code></a> function returns the time-domain apodization vector:</p><pre><code class="language-julia hljs"># Load a spectrum
spec = exampledata(&quot;2D_HN&quot;)

# Get apodization function for F2 dimension
apod_function = apod(spec, F2Dim)

println(&quot;Apodization vector length: &quot;, length(apod_function))
println(&quot;First few values: &quot;, apod_function[1:5])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Apodization vector length: 512
First few values: [1.0, 0.9996988186962042, 0.9987954562051724, 0.9972904566786902, 0.9951847266721969]</code></pre><p>You can also compute it directly from a dimension:</p><pre><code class="language-julia hljs">dim = dims(spec, F2Dim)
apod_function = apod(dim)</code></pre><p>By default, the apodization vector is zero-filled to match <code>tdzf</code>. To get only the acquired points:</p><pre><code class="language-julia hljs">apod_function = apod(spec, F2Dim, false)  # zerofill=false</code></pre><h3 id="Simulating-lineshapes"><a class="docs-heading-anchor" href="#Simulating-lineshapes">Simulating lineshapes</a><a id="Simulating-lineshapes-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-lineshapes" title="Permalink"></a></h3><p>The <a href="../api/#NMRTools.NMRBase.lineshape-Tuple{Any, Any, Any, LineshapeComplexity}"><code>lineshape</code></a> function generates a simulated spectrum including the effect of the window function:</p><pre><code class="language-julia hljs"># Get the F2 axis
axis = dims(spec, F2Dim)

# Simulate a peak at 8.5 ppm with R2 = 10 s-1
chemical_shift = 8.5  # ppm
R2 = 10.0            # s-1
simulated = lineshape(axis, chemical_shift, R2)

println(&quot;Simulated lineshape length: &quot;, length(simulated))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Simulated lineshape length: 512</code></pre><p>This is useful for:</p><ul><li>Fitting experimental peaks</li><li>Understanding window function effects</li><li>Quality control and validation</li></ul><p>You can also request complex-valued lineshapes:</p><pre><code class="language-julia hljs"># Get complex lineshape
simulated_complex = lineshape(axis, chemical_shift, R2, ComplexLineshape())</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metadata-fqlists/">« Frequency lists</a><a class="docs-footer-nextpage" href="../utilities/">Utilities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 30 November 2025 00:25">Sunday 30 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
