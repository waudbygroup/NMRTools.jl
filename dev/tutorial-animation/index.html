<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Animating spectra · NMRTools.jl</title><meta name="title" content="Animating spectra · NMRTools.jl"/><meta property="og:title" content="Animating spectra · NMRTools.jl"/><meta property="twitter:title" content="Animating spectra · NMRTools.jl"/><meta name="description" content="Documentation for NMRTools.jl."/><meta property="og:description" content="Documentation for NMRTools.jl."/><meta property="twitter:description" content="Documentation for NMRTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NMRTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NMRTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorial-data/">Working with NMR data</a></li><li><a class="tocitem" href="../tutorial-plotrecipes/">Plotting</a></li><li><a class="tocitem" href="../tutorial-peaks/">Peak detection</a></li><li><a class="tocitem" href="../tutorial-metadata/">Metadata</a></li><li class="is-active"><a class="tocitem" href>Animating spectra</a><ul class="internal"><li><a class="tocitem" href="#Phosphorylation-kinetics"><span>Phosphorylation kinetics</span></a></li><li><a class="tocitem" href="#2D-titration"><span>2D titration</span></a></li></ul></li><li><a class="tocitem" href="../tutorial-relaxation/">1D relaxation analysis</a></li><li><a class="tocitem" href="../tutorial-diffusion/">Diffusion analysis</a></li></ul></li><li><span class="tocitem">Metadata</span><ul><li><a class="tocitem" href="../metadata/">Overview</a></li><li><a class="tocitem" href="../metadata-timeunits/">Times and frequencies</a></li><li><a class="tocitem" href="../metadata-power/">Power levels</a></li><li><a class="tocitem" href="../metadata-fqlists/">Frequency lists</a></li><li><a class="tocitem" href="../metadata-windows/">Window functions</a></li><li><a class="tocitem" href="../metadata-samples/">Sample metadata</a></li></ul></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><span class="tocitem">Reference guide</span><ul><li><a class="tocitem" href="../ref-referencing/">Chemical shift referencing</a></li><li><a class="tocitem" href="../ref-metadata/">Metadata</a></li><li><a class="tocitem" href="../ref-annotations/">Annotations</a></li><li><a class="tocitem" href="../ref-coherences/">Coherences and isotope data</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../indexes/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Animating spectra</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Animating spectra</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRTools.jl/blob/master/docs/src/tutorial-animation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Animating-spectra"><a class="docs-heading-anchor" href="#Animating-spectra">Animating spectra</a><a id="Animating-spectra-1"></a><a class="docs-heading-anchor-permalink" href="#Animating-spectra" title="Permalink"></a></h1><p>The plot recipes defined within NMRTools provide an easy way to generate animations of spectral data, using the <code>@animate</code> macro defined within the Plots package. A couple of examples are provided below.</p><h2 id="Phosphorylation-kinetics"><a class="docs-heading-anchor" href="#Phosphorylation-kinetics">Phosphorylation kinetics</a><a id="Phosphorylation-kinetics-1"></a><a class="docs-heading-anchor-permalink" href="#Phosphorylation-kinetics" title="Permalink"></a></h2><p>First, load in some data. This pseudo-3D kinetic data - a series of 1H,15N SOFAST-HMQC spectra - showing the progressive phosphorylation of cJun by JNK1 kinase. Read more about the paper here: <a href="https://www.nature.com/articles/s41467-022-33866-w">Waudby et al. Nat Commun (2022)</a>.</p><pre><code class="language-julia hljs">using NMRTools, Plots

spec=exampledata(&quot;pseudo3D_kinetics&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> Downloading artifact: pseudo3D_kinetics</code></pre><p>The data have been processed in Topspin using <code>ftnd 3</code> and <code>ftnd 2</code>, so that the final dimension of the 3D represents the phosphorylation time. Each 2D plane took 2 minutes to acquire, and there was an initial delay of 4 min between adding the kinase and recording the first free induction decay. We need to calculate a list of times from this information, that we can use to label the animation:</p><pre><code class="language-julia hljs"># get number of time points
nt = size(spec,3)

# calculate a list of measurement times
# experiment was recorded with 2 min per spectrum, plus initial dead-time of 4 min
tmin = LinRange(0, 2*(nt-1), nt) .+ 4
thr = tmin / 60</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">256-element LinRange{Float64, Int64}:
 0.0666667, 0.1, 0.133333, 0.166667, 0.2, …, 8.46667, 8.5, 8.53333, 8.56667</code></pre><p>Now we can generate the animation, by looping over each point in the time series with the Plots <code>@animate</code> macro, then saving as an animated gif.</p><pre><code class="language-julia hljs">anim = @animate for i=1:nt
    # generate a nice title with the time rounded to 1 decimal place, e.g. &quot;Time elapsed: 0.1 hr&quot;
    titletext = &quot;Time elapsed: $(round(thr[i],digits=1)) hr&quot;
    plot(spec[:,:,i], title=titletext)
end

# save as an animated gif
gif(anim, &quot;kinetics.gif&quot;, fps=30)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/NMRTools.jl/NMRTools.jl/docs/build/kinetics.gif</code></pre><p><img src="../kinetics.gif" alt/></p><h2 id="2D-titration"><a class="docs-heading-anchor" href="#2D-titration">2D titration</a><a id="2D-titration-1"></a><a class="docs-heading-anchor-permalink" href="#2D-titration" title="Permalink"></a></h2><p>First, load in some data - as described in the <a href="../tutorial-plotrecipes/#Overlaying-multiple-2D-spectra">tutorial on plotting</a>.</p><pre><code class="language-julia hljs">spectra2d = exampledata(&quot;2D_HN_titration&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> Downloading artifact: 2D_HN_titration</code></pre><p>Now loop over the spectra to produce the animation:</p><pre><code class="language-julia hljs">refspec = spectra2d[1]
anim=@animate for spec in spectra2d
    plot(spec, xlims=(6,10.5), title=label(spec), normalize=refspec)
end

gif(anim, &quot;titration.gif&quot;, fps=8)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/NMRTools.jl/NMRTools.jl/docs/build/titration.gif</code></pre><p><img src="../titration.gif" alt/></p><div class="admonition is-info" id="Note-dd834fec78ab0a"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-dd834fec78ab0a" title="Permalink"></a></header><div class="admonition-body"><p>The <code>normalize=refspec</code> parameter scales all spectra relative to the reference spectrum, defined on the first line as the first spectrum in the titration series. This ensures that contour levels are directly comparable across the different spectra. This normalization automatically compensates for differences in acquisition parameters such as number of scans and receiver gain that would otherwise affect absolute intensities.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial-metadata/">« Metadata</a><a class="docs-footer-nextpage" href="../tutorial-relaxation/">1D relaxation analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 2 January 2026 13:08">Friday 2 January 2026</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
