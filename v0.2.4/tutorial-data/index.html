<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Working with NMR data · NMRTools.jl</title><meta name="title" content="Working with NMR data · NMRTools.jl"/><meta property="og:title" content="Working with NMR data · NMRTools.jl"/><meta property="twitter:title" content="Working with NMR data · NMRTools.jl"/><meta name="description" content="Documentation for NMRTools.jl."/><meta property="og:description" content="Documentation for NMRTools.jl."/><meta property="twitter:description" content="Documentation for NMRTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NMRTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NMRTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Working with NMR data</a><ul class="internal"><li><a class="tocitem" href="#Loading-NMR-data"><span>Loading NMR data</span></a></li><li><a class="tocitem" href="#Manipulating-spectrum-data"><span>Manipulating spectrum data</span></a></li><li><a class="tocitem" href="#Accessing-axis-data"><span>Accessing axis data</span></a></li><li><a class="tocitem" href="#Chemical-shift-referencing"><span>Chemical shift referencing</span></a></li><li><a class="tocitem" href="#Accessing-metadata"><span>Accessing metadata</span></a></li></ul></li><li><a class="tocitem" href="../tutorial-plotrecipes/">Plotting</a></li><li><a class="tocitem" href="../tutorial-peaks/">Peak detection</a></li><li><a class="tocitem" href="../tutorial-metadata/">Metadata</a></li><li><a class="tocitem" href="../tutorial-animation/">Animating spectra</a></li><li><a class="tocitem" href="../tutorial-relaxation/">1D relaxation analysis</a></li><li><a class="tocitem" href="../tutorial-diffusion/">Diffusion analysis</a></li></ul></li><li><span class="tocitem">Metadata</span><ul><li><a class="tocitem" href="../metadata/">Overview</a></li><li><a class="tocitem" href="../metadata-timeunits/">Times and frequencies</a></li><li><a class="tocitem" href="../metadata-power/">Power levels</a></li><li><a class="tocitem" href="../metadata-fqlists/">Frequency lists</a></li><li><a class="tocitem" href="../metadata-windows/">Window functions</a></li><li><a class="tocitem" href="../metadata-samples/">Sample metadata</a></li></ul></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><span class="tocitem">Reference guide</span><ul><li><a class="tocitem" href="../ref-metadata/">Metadata</a></li><li><a class="tocitem" href="../ref-annotations/">Annotations</a></li><li><a class="tocitem" href="../ref-coherences/">Coherences and isotope data</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../indexes/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Working with NMR data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Working with NMR data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRTools.jl/blob/master/docs/src/tutorial-data.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Working-with-NMR-data"><a class="docs-heading-anchor" href="#Working-with-NMR-data">Working with NMR data</a><a id="Working-with-NMR-data-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-NMR-data" title="Permalink"></a></h1><p>NMR measurements are arrays of data, with additional numerical data associated with each dimension, or axis. Within NMRTools, these data are stored as <a href="../api/#NMRTools.NMRBase.NMRData"><code>NMRData</code></a> structures, which provides a convenient way to encapsulate both the data, axis information, and additional metadata providing information on acquisition or processing.</p><h2 id="Loading-NMR-data"><a class="docs-heading-anchor" href="#Loading-NMR-data">Loading NMR data</a><a id="Loading-NMR-data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-NMR-data" title="Permalink"></a></h2><p>NMR data are loaded using the <a href="../api/#NMRTools.NMRIO.loadnmr-Tuple{Any}"><code>loadnmr</code></a> function. This can handle processed Bruker experiments, or NMRPipe-format data.</p><pre><code class="language-julia hljs"># load bruker experiment number 1 from a directory &#39;2D_HN&#39;
# by default, NMRTools will load bruker processed data from proc 1
spec2d = loadnmr(&quot;exampledata/2D_HN/1&quot;)

# load a different processed spectrum
spec1d = loadnmr(&quot;exampledata/2D_HN/1/pdata/101&quot;)

# load data from NMRPipe format, using a template
spec3d = loadnmr(&quot;exampledata/pseudo3D_HN_R2/1/ft/test%03d.ft2&quot;)</code></pre><div class="admonition is-success" id="Tip-3ff5a57a9ed8bd06"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-3ff5a57a9ed8bd06" title="Permalink"></a></header><div class="admonition-body"><p><code>loadnmr</code> will attempt to locate and parse acquisition metadata, such as acqus files. If the spectrum file is located elsewhere (for example, if you are loading a file that was processed with NMRPipe), then you can specify the path to the experiment folder using the <code>experimentfolder</code> keyword argument.</p></div></div><p>When spectra are loaded, a simple algorithm runs to estimate the noise level, which is often used for subsequent plotting commands.</p><h2 id="Manipulating-spectrum-data"><a class="docs-heading-anchor" href="#Manipulating-spectrum-data">Manipulating spectrum data</a><a id="Manipulating-spectrum-data-1"></a><a class="docs-heading-anchor-permalink" href="#Manipulating-spectrum-data" title="Permalink"></a></h2><p><a href="../api/#NMRTools.NMRBase.NMRData"><code>NMRData</code></a> structures encapsulate a standard Julia array. This can be accessed using the <a href="../api/#NMRTools.NMRBase.data-Tuple{NMRData, Any}"><code>data</code></a> command. However, through the magic of multiple dispatch, most operations will work transparently on NMRData variables as if they are regular arrays, with the added benefit that axis information and metadata are preserved. Data can be sliced and accessed like a regular array using the usual square brackets:</p><pre><code class="language-julia hljs">spec1d[100:105]
spec2d[3:4, 10:14]</code></pre><p>However, more conveniently, value-based selectors can also be used to locate data using chemical shifts. Three selectors are defined:</p><ul><li><code>At(x)</code>: select data precisely at the specified value</li><li><code>Near(x)</code>: select data at the nearest matching position</li><li><code>x .. y</code>: select the range of data between <code>x</code> and <code>y</code> (closed interval)</li></ul><p>For example:</p><pre><code class="language-julia hljs">spec1d[8.2 .. 8.3] # select between 8.2 and 8.3 ppm
spec2d[Near(8.25), 123 .. 124] # select near 8.25 ppm in the first dimension
                               # and between 123 and 124 ppm in the second dimension</code></pre><p>When data are sliced, new NMRData structures are created and their axes are updated to match the new data size.</p><div class="admonition is-warning" id="Warning-ff2691bb3d6fae59"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-ff2691bb3d6fae59" title="Permalink"></a></header><div class="admonition-body"><p>When <code>NMRData</code> structures are sliced, copied, or otherwise modified, they inherit the same dictionary of metadata as the original variable. This means that any changes to metadata will affect both variables. To resolve this, make a <code>deepcopy</code> of the variable. Note also that any acquisition metadata might not reflect the correct shape of the data any more.</p></div></div><h2 id="Accessing-axis-data"><a class="docs-heading-anchor" href="#Accessing-axis-data">Accessing axis data</a><a id="Accessing-axis-data-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-axis-data" title="Permalink"></a></h2><p>Information on data dimensions is stored in <code>NMRDimension</code> structures. These can be accessed with the <code>dims</code> function:</p><pre><code class="language-julia hljs"># get the first dimension of this two-dimensional experiment
dims(spec2d, 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_5" style="color:#ff875f">F1Dim</span> Sampled{Float64} <span class="sgr38_5" style="color:#808080">ReverseOrdered</span> <span class="sgr38_5" style="color:#808080">Regular</span> <span class="sgr38_5" style="color:#808080">DimensionalData.Dimensions.Lookups.Points</span>
<span class="sgr90">wrapping: </span>1216-element LinRange{Float64, Int64}:
 11.0712, 11.0668, 11.0624, 11.058, …, 5.7357, 5.73129, 5.72689, 5.72249</code></pre><p><code>NMRDimension</code>s can be treated like vectors (one-dimensional arrays) for most purposes, including indexing and slicing. Value-based selectors can also be used, as for spectrum data. Like spectrum data, the underlying numerical data can be accessed if needed using the <a href="../api/#NMRTools.NMRBase.data-Tuple{NMRData, Any}"><code>data</code></a> function.</p><p>A heirarchy of types are defined for NMR dimensions, reflecting the variety of different experiments:</p><ul><li><code>NMRDimension</code><ul><li><code>FrequencyDimension</code>: with specific types <code>F1Dim</code> to <code>F4Dim</code></li><li><code>NonFrequencyDimension</code><ul><li><code>TimeDimension</code>:<ul><li><code>TrelaxDim</code>: for relaxation times</li><li><code>TkinDim</code>: for kinetic evolution times</li><li><code>T1Dim</code> to <code>T4Dim</code>: for general frequency evolution periods</li></ul></li><li><code>GradientDimension</code>: for e.g. diffusion measurements, with specific types <code>G1Dim</code> to <code>G4Dim</code></li><li><code>UnknownDimension</code>: with specific types <code>X1Dim</code> to <code>X4Dim</code></li></ul></li></ul></li></ul><h2 id="Chemical-shift-referencing"><a class="docs-heading-anchor" href="#Chemical-shift-referencing">Chemical shift referencing</a><a id="Chemical-shift-referencing-1"></a><a class="docs-heading-anchor-permalink" href="#Chemical-shift-referencing" title="Permalink"></a></h2><p>The <code>shiftdim</code> function allows you to adjust the referencing of your NMR spectrum by adding a specified offset to the chemical shift values along a given dimension. This can be useful if you need to correct referencing errors or align spectra.</p><p>To use <code>shiftdim</code>, you need to specify the NMRData object, the dimension to adjust, and the offset value to add. Here is a simple example:</p><pre><code class="language-julia hljs"># Load example data
spec2d_original = exampledata(&quot;2D_HN&quot;)

# Add an offset of 0.1 ppm to the first dimension (specified as a number)
spec2d = shiftdim(spec2d_original, 1, 0.1)

# Add a further offset of -0.5 ppm to the second dimension (specified as F2Dim)
spec2d = shiftdim(spec2d, F2Dim, -0.5)

label!(spec2d_original, &quot;unreferenced&quot;)
label!(spec2d, &quot;referenced&quot;)
plot([spec2d_original, spec2d])</code></pre><p><img src="../plot-offset.svg" alt/></p><p>In this example, the chemical shift values in the first dimension of <code>spec2d</code> are increased by 0.1 ppm, and the values in the second dimension are decreased by 0.5 ppm.</p><div class="admonition is-info" id="Note-582516afe7dcb6e2"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-582516afe7dcb6e2" title="Permalink"></a></header><div class="admonition-body"><p>The <code>shiftdim</code> function will adjust metadata (<code>:offsetppm</code>, <code>:offsethz</code> and <code>:sf</code>) to keep track of the altered referencing. A new metadata entry <code>:referenceoffset</code> will be created to keep track of this referencing.</p></div></div><h2 id="Accessing-metadata"><a class="docs-heading-anchor" href="#Accessing-metadata">Accessing metadata</a><a id="Accessing-metadata-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-metadata" title="Permalink"></a></h2><p><a href="../api/#NMRTools.NMRBase.NMRData"><code>NMRData</code></a> objects contain comprehensive metadata on processing and acquisition parameters that are populated automatically upon loading a spectrum. Entries are divided into <em>spectrum</em> metadata - associated with the experiment in general - and <em>axis</em> metadata, that are associated with a particular dimension of the data.</p><p>Metadata entries are labelled by symbols such as <code>:ns</code> or <code>:pulseprogram</code>. Entries can be accessed using the <code>metadata</code> function, or directly as a dictionary-style lookup:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; metadata(spec2d, :ns)</code><code class="nohighlight hljs ansi" style="display:block;">2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; spec2d[:title]</code><code class="nohighlight hljs ansi" style="display:block;">&quot;13C,15N ubiquitin\n500 uM in 10% D2O, 20 mM Pi pH 6.5, 277 K, SOFAST-HMQC&quot;</code></pre><p>Acquisition parameters from Bruker acqus files are also parsed when loading data, and can be accessed using the <a href="../api/#NMRTools.NMRBase.acqus-Tuple{AbstractNMRData}"><code>acqus</code></a> function. Parameters are specified either as lower-case symbols or strings (not case-sensitive). An index can be specified for arrayed parameters such as pulse lengths or delays.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; acqus(spec2d, &quot;TE&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">276.9988</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; acqus(spec2d, :p, 1)</code><code class="nohighlight hljs ansi" style="display:block;">9.199999999999998e-6</code></pre><p>Axis metadata can be accessed by providing an additional label, which can either be numerical or the appropriate <code>NMRDimension</code> type, such as <code>F1Dim</code> etc:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; metadata(spec2d, F2Dim, :label)</code><code class="nohighlight hljs ansi" style="display:block;">&quot;15N&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; spec2d[2, :bf]</code><code class="nohighlight hljs ansi" style="display:block;">6.0817738e7</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; spec2d[F2Dim, :window]</code><code class="nohighlight hljs ansi" style="display:block;">CosWindow(0.04783359999999993)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quickstart/">« Getting started</a><a class="docs-footer-nextpage" href="../tutorial-plotrecipes/">Plotting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 8 December 2025 13:04">Monday 8 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
